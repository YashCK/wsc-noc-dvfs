
// Final Paper Simulation Config
// Topology: mesh, Policy: queue_pid
// Injection Rate: 0.4, Power Cap: 0.7W

// VC Configuration
read_request_begin_vc  = 0;
read_request_end_vc    = 5;
write_reply_begin_vc   = 2;
write_reply_end_vc     = 7;
read_reply_begin_vc    = 8;
read_reply_end_vc      = 12;
write_request_begin_vc = 10;
write_request_end_vc   = 15;
num_vcs     = 16;
vc_buf_size = 8;
wait_for_tail_credit = 0;
vc_allocator = max_size;
sw_allocator = max_size;
alloc_iters  = 2;
credit_delay   = 2;
routing_delay  = 0;
vc_alloc_delay = 1;
sw_alloc_delay = 1;
st_final_delay = 1;
input_speedup     = 1;
output_speedup    = 1;
internal_speedup  = 1.0;

// Detailed simulation settings (longer runs for accuracy)
sim_type = latency;
warmup_periods = 3;
sim_count = 1;
sample_period  = 10000;
max_samples = 15;
use_read_write = 0;
batch_size = 10000;
latency_thres = 5000;
packet_size = 1;

// Topology

topology = mesh;
k  = 8;
n  = 2;
routing_function = dor;


// Traffic - 2 classes with different priorities
// Using uniform traffic with configurable injection rate
// Split injection: 30% control (class 0), 70% batch (class 1)
traffic = uniform;
injection_rate = {0.12,0.27999999999999997};

// 2-class traffic for SLO-aware policies
classes = 2;
class_priority = {1,0};
class_slo = {50,-1};
priority_policy = static_class;

// Orion power model
use_orion = 1;
Vdd = 1.0;
Orion_tr = 0.2;
Orion_Freq = 1e9;
Orion_inport = 5;
Orion_outport = 5;
Orion_bitwidth = 128;
Orion_vc_class = 1;
Orion_IsSharedBuffIn = 0;
Orion_IsSharedBuffOut = 0;
Orion_crossbar_model = 0;
Orion_crsbar_degree = 4;
Orion_Cxbar_Cxpoint = 0;
Orion_trans_type = 0;
Orion_IsInBuff = 1;
Orion_out_buf_size = 0;
Orion_IsOutBuff = 0;
Orion_buff_type = 0;
Orion_in_arb_model = 1;
Orion_out_arb_model = 1;
Orion_allocator_model = 1;
Orion_in_vc_arb_model = 1;
Orion_out_vc_arb_model = 1;
wire_length = 1.0;

// Power cap
power_cap = 0.7;

// DVFS base settings
dvfs_epoch = 10000;
dvfs_log_interval = 10000;
dvfs_freqs = 1.0;
dvfs_voltages = 1.0;
router_domains = 0;

// Policy-specific settings

dvfs_policy = queue_pid;
dvfs_min_scale = 0.5;
dvfs_max_scale = 1.0;
queue_pid_target = 0.02;
queue_pid_kp = 0.5;
queue_pid_ki = 0.01;
queue_pid_kd = 0.1;
queue_pid_per_router = 1;
queue_pid_headroom_margin = 0.05;
control_class_id = 0;
control_slo_cycles = 50.0;


// Output files
latency_csv = latency.csv;
stall_csv = stalls.csv;
throughput_csv = throughput.csv;
summary_csv = summary.csv;
energy_csv = energy.csv;
epoch_csv = epoch.csv;
dvfs_log = power_log;
output_dir = /Users/yash/Projects/wsc-noc-dvfs/final_paper_sims/mesh;
run_name = mesh_queue_pid_inj0.4_cap0.7;
